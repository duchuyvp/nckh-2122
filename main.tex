
\documentclass[12pt]{article}


% \usepackage{vntex}
\usepackage[english, vietnamese]{babel}
% \usepackage[left=2.00cm, right=2.00cm, top=2.00cm, bottom=2.00cm]{geometry}

\usepackage{enumerate}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{color}

\usepackage{tikz}
\usepackage{pgfplots}

\usepackage{mathrsfs}

\usepackage[utf8]{inputenc}
% \usepackage[T5]{fontenc}


% \usepackage{amsthm}
\usepackage[unicode]{hyperref}

\usepackage{graphicx}
\usepackage{enumitem}
\usepackage{a4wide}
\usepackage{epsfig}
\usepackage{latexsym}
\usepackage{array}
\usepackage{hhline}
\usepackage{fancyhdr}
\usepackage[normalem]{ulem}
\usepackage[makeroom]{cancel}
\usepackage{longtable}
\usepackage{amscd}
\usepackage{diagbox}
\usepackage{booktabs}
\usepackage{alltt}
\usepackage[framemethod=tikz]{mdframed}
\usepackage{subcaption}
\usepackage{caption}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{lipsum}
\usepackage{setspace}
% \usepackage{titling}
\usepackage{multicol}
% \usepackage{indentfirst}
\usepackage{float}
\usepackage{titlesec}

\usetikzlibrary{decorations}
\usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{decorations.pathreplacing,calligraphy}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{quotes}
\usetikzlibrary{intersections}
\usetikzlibrary{calc}
\usetikzlibrary{arrows}
\pagestyle{empty}
% \setstretch{1.25}
\pgfplotsset{compat=1.15}
\setlength{\topmargin}{-0.6in}
\setlength{\textheight}{9in}
\setlength{\oddsidemargin}{0.125in}
\setlength{\textwidth}{6.25in}

% \setcounter{MaxMatrixCols}{30}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{acknowledgement}[theorem]{Acknowledgement}
\newtheorem{algorithm}[theorem]{Algorithm}
\newtheorem{axiom}[theorem]{Axiom}
\newtheorem{case}[theorem]{Case}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{conclusion}[theorem]{Conclusion}
\newtheorem{condition}[theorem]{Condition}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{criterion}[theorem]{Criterion}
\newtheorem{definition}{Definition}
\newtheorem{example}{Example}
\newtheorem{exercise}[theorem]{Exercise}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{notation}[theorem]{Notation}
\newtheorem{problem}[theorem]{Problem}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{remark}{Remark}
\newtheorem{solution}[theorem]{Solution}
\newtheorem{summary}[theorem]{Summary}
% \newtheorem*{recap}{Recap}
\newenvironment{proof}[1][Proof]{\noindent\textbf{#1.} }
{\hfill \ \rule{0.5em}{0.5em}}
% \newmdenv[linecolor=black,skipabove=\topsep,skipbelow=\topsep,
% leftmargin=-5pt,rightmargin=-5pt,
% innerleftmargin=5pt,innerrightmargin=5pt]{textbox}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\lstset{
%   frame=tb,
    language=Java,
    aboveskip=3mm,
    belowskip=3mm,
    showstringspaces=false,
    columns=flexible,
    basicstyle={\small\ttfamily},
    numbers=none,
    numberstyle=\tiny\color{gray},
    keywordstyle=\color{blue},
    commentstyle=\color{dkgreen},
    stringstyle=\color{mauve},
    breaklines=true,
    breakatwhitespace=true,
    tabsize=3
}

\title{Tìm hiểu về mật mã đường cong Elliptic và ứng dụng}
\author{
    Nguyễn Đức Huy\thanks{Khoa Toán, Đại học Khoa học Tự Nhiên, \url{mtait@math.ucsd.edu}}
    \and
    Lê Thị Thùy Dung\thanks{Khoa Toán, Đại học Khoa học Tự Nhiên, \mbox{\url{craig.timmons@csus.edu}}}
    \and
    Lưu Hiểu Huy\thanks{Khoa Toán, Đại học Khoa học Tự Nhiên, \mbox{\url{craig.timmons@csus.edu}}}
}
\date{}

\begin{document}
\maketitle
\tableofcontents
\begin{abstract}
    Mật mã đường cong Elliptic là phương pháp tiếp cận mã hóa khóa công khai dựa trên cấu trúc đại số của đường cong Elliptic trên các trường hữu hạn.
    Đường cong elliptic bao gồm các điểm thỏa mãn phương trình $Y^2=X^3+AX+B$ cùng với một điểm $O$ ở vô cực. Chúng tôi sẽ giới thiệu và phân tích hệ mật mã
    dựa trên đường cong elliptic bao gồm các bài toán Logarit rời rạc, trao đổi khóa, mã hóa - giải mã, chữ kí số, ... và một số ứng dụng của nó trong mật mã
    như thuật toán phân tích thành nhân tử của đường cong elliptic Lenstra, thuật toán kiểm tra tính nguyên tố Pocklington-Lehmer.
\end{abstract}

\section{Giới thiệu}

\section{Đường cong Elliptic}
Một \textit{đường cong Elliptic} là tập nghiệm của một phương trình có dạng
$$Y^2 = X^3 + AX + B$$
Các phương trình thuộc loại này được gọi là \textit{phương trình Weierstrass} sau khi ông đã nghiên cứu chúng trong suốt thể kỉ XIX. Hai ví dụ cho đường cong elliptic:
$$ E_1: Y^2=X^3-3X+3 $$ và $$ E_2: Y^2=X^3-5X+5 $$ được minh họa ở \ref*{aaa}

\begin{figure}[H]
    \caption{Hình 1}
    \label{aaa}
    \begin{minipage}{0.4\textwidth}
        \centering
        \begin{tikzpicture}[scale = 0.5, line cap=round,line join=round,>=triangle 45,x=1cm,y=1cm]
            \begin{axis}[
                    x=1cm,y=1cm,
                    axis lines=middle,
                    xmin=-5.912600967627929,
                    xmax=5.112504977805202,
                    ymin=-5.000000419005899,
                    ymax=5.000000419005899,
                    xtick={-5,-4,...,5},
                    ytick={-5,-4,...,5},]
                \clip(-5.912600967627929,-5.000000419005899) rectangle (10.112504977805202,5.000000419005899);
                \draw[line width=2pt,color=blue,smooth,samples=100,domain=-2.1038033040947663:10.112504977805202] plot(\x,{sqrt((\x)^(3)-3*(\x)+3)});
                \draw[line width=2pt,color=blue,smooth,samples=100,domain=-2.1038033040947663:10.112504977805202] plot(\x,{0-sqrt((\x)^(3)-3*(\x)+3)});
            \end{axis}
        \end{tikzpicture}
    \end{minipage}
    \hfill
    \begin{minipage}{0.4\textwidth}
        \centering
        \begin{tikzpicture}[scale = 0.5, line cap=round,line join=round,>=triangle 45,x=1cm,y=1cm]
            \begin{axis}[
                    x=1cm,y=1cm,
                    axis lines=middle,
                    xmin=-5.912600967627929,
                    xmax=5.112504977805202,
                    ymin=-5.000000419005899,
                    ymax=5.000000419005899,
                    xtick={-5,-4,...,5},
                    ytick={-5,-4,...,5},]
                \clip(-5.912600967627929,-5.000000419005899) rectangle (10.112504977805202,5.000000419005899);
                \draw[line width=2pt,color=blue,smooth,samples=100,domain=-2.791287717641796:0.9999998864501113] plot(\x,{sqrt(abs((\x)^(3)-6*(\x)+5))});
                \draw[line width=2pt,color=blue,smooth,samples=100,domain=1.791293439719924:10.112505461619168] plot(\x,{sqrt(abs((\x)^(3)-6*(\x)+5))});
                \draw[line width=2pt,color=blue,smooth,samples=100,domain=-2.791287717641796:0.9999998864501113] plot(\x,{0-sqrt(abs((\x)^(3)-6*(\x)+5))});
                \draw[line width=2pt,color=blue,smooth,samples=100,domain=1.791293439719924:10.112505461619168] plot(\x,{0-sqrt(abs((\x)^(3)-6*(\x)+5))});
            \end{axis}
        \end{tikzpicture}
    \end{minipage}
\end{figure}


Một điều tuyệt vời của đường cong elliptic là có một cách tự nhiên để chọn hai điểm trên đường cong và
``cộng'' chúng để tạo ra điểm thứ ba. Phép ``cộng'' được chúng tôi nhắc đến ở đây là một phép toán kết hợp hai điểm theo cách tương tự với phép cộng thông thường
ở một vài khía cạnh (có tính chất giao hoán, kết hợp và có cách nhận dạng), nhưng rất khác ở những phần còn lại. Một trong những cách đơn giản để miêu tả "luật cộng" là sử dụng hình học.

Cho $P$ và $Q$ là hai điểm trên đường cong elliptic $E$, như minh họa ở Hình 2. Ta bắt đầu vẽ một đường thẳng $L$ đi qua $P$ và $Q$. Đường thẳng
$L$ sẽ cắt $E$ tại ba điểm $P$, $Q$ và một điểm $R$ thứ ba. Ta lấy đối xứng điểm $R$ qua trục $Ox$ để được điểm $R'$. Điểm $R'$ này gọi là \textit{tổng của $P$ và $Q$},
phép ``cộng'' này không giống phép cộng thông thường. Ta biểu thị phép ``cộng'' này bằng kí hiệu $\oplus$. Ta viết
\begin{equation}
    P \oplus Q = R'
\end{equation}

\begin{example}
    \label{ex:ex1}
    Cho đường cong elliptic E:
    \begin{equation}
        \label{eq:curve}
        Y^2 = X^3 -15X + 18
    \end{equation}
\end{example}
Điểm $P = (7,16)$ và $Q = (1,2)$ nằm trên $E$. Đường thẳng $L$ nối $P$ và $Q$ có phương trình
\begin{equation}
    \label{eq:line}
    L: Y = \frac{7}{3}X - \frac{1}{3}
\end{equation}
Để tìm giao điểm của $E$ và $L$, ta thay $Y$ ở phương trình \eqref{eq:line} vào phương trình \eqref{eq:curve} để tìm $X$. Ta có
\begin{center}

    $
        \begin{array}{rcl}
            (\frac{7}{3}X - \frac{1}{3})^2                & = & X^3 -15X+18                                        \\
            \frac{49}{9}X^2 - \frac{14}{9}X + \frac{1}{9} & = & X^3 -15X+18                                        \\
            0                                             & = & X^3 -\frac{49}{9}X^2 -\frac{121}{9}X+\frac{161}{9} \\
        \end{array}
    $
\end{center}
Thông thường, việc tìm nghiệm của phương trình bậc ba không đơn giản, nhưng ta đã biết trước 2 giao điểm của $L$ và $E$ là $P$ và $Q$, nên rõ ràng phương trình trên
có 2 nghiệm $X=1$ và $X=7$. Từ đó, ta dễ dàng tìm được nghiệm còn lại
$$X^3 -\frac{49}{9}X^2 -\frac{121}{9}X+\frac{161}{9} = (X-7) \centerdot  (X-1) \centerdot (X+\frac{23}{9})$$

Thay $X=-\frac{23}{9}$ vào phương trình \eqref{eq:line} ta được điểm $R = (-\frac{23}{9}, -\frac{170}{27})$. Cuối cùng, lấy đối xứng qua trục $Ox$ ta được
$$P \oplus Q = (-\frac{23}{9}, \frac{170}{27})$$

Điều gì xảy ra khi ta cộng điểm $P$ với chính nó?
Khi điểm $Q$ tiến dần đến $P$, đường thẳng $L$ sẽ trở thành tiếp tuyến của $E$ tại $P$. Vậy, để cộng điểm $P$ với chính nó, ta đơn giản chỉ cần lấy $L$ là
tiếp tuyến của $E$ tại $P$, minh họa ở hình 3. Khi đó $L$ giao $E$ tại $P$ và một điểm $R$ khác, điểm $P$ được tính 2 lần.

\begin{example}
    \label{ex:ex2}
    Tiếp tục với đường cong $E$ và điểm $P$

    Để sau viết tiếp
\end{example}

Vấn đề thứ hai là khi ta cố gắng cộng điểm $P=(a,b)$ với điểm đỗi xứng của nó qua trục $Ox$ $P'=(a,-b)$.
Đường thẳng $L$ đi qua $P$ và $P'$ có phương trình $x=a$, chỉ cắt $E$ tại 2 điểm $P$ và $P'$. (Hình 4)
Vậy nên không có giao điểm thứ ba. Giải pháp là tạo thêm một điểm $\mathcal{O}$ ở "vô cực".
Chính xác hơn, điểm $\mathcal{O}$ không tồn tại trên mặt phẳng $ Oxy$, nhưng ta giả định nó nằm trên mọi đường thẳng đứng.
Ta có:
$$ P \oplus P' = \mathcal{O}$$

Tiếp theo, ta cần tìm cách  cộng điểm $\mathcal{O}$ với điểm $P = (a,b)$ thuộc $E$.
Đường thẳng $L$ nối $P$ với $\mathcal{O}$ là đường thẳng đứng đi qua $P$ và cắt $E$ tại $P'=(a,-b)$.
Để cộng $P$ với $\mathcal{O}$, ta lấy điểm đối xứng với $P'$ qua trục $Ox$, ta được điểm $P$.
Nói cách khác $P \oplus \mathcal{O} = P$, vậy điểm $\mathcal{O}$ có vai trò như số 0 trong phép cộng elliptic.

\begin{example}
    \label{ex:ex3}
\end{example}

\begin{definition}
    Một đường cong elliptic $E$ là tập nghiệm của một phương trình Weierstrass:
    $$E : Y^2 = X^3 + AX+ B$$
    cùng với một điểm $\mathcal{O}$ ở vô cùng, trong đó hẳng số $A$ và $B$ thỏa mãn
    $$ 4A^3 + 27B^2 \neq 0$$
\end{definition}
\indent Phép cộng trên $E$ được định nghĩa như sau. Cho 2 điểm $P$ và $Q$ là 2 điểm thuộc $E$.
$L$ là đường thẳng nối $P$ và $Q$, hoặc là đường tiếp tuyến của $E$ tại $P$ nếu $P=Q$.
Khi đó, giao điểm của $E$ và $L$ là ba điểm $P$, $Q$ và $R$, với $\mathcal{O}$
là một điểm ở vô cực, năm trên mọi đường thẳng đứng. $R=(a,b)$, tổng của $P$ và $Q$
là điểm $R'=(a,-b)$. Tổng này được ký hiệu là $P \oplus Q$, cơ thể viết đơn giản $P+Q$.

\begin{remark}
    Tại sao cần thỏa mãn điều kiện $4A^3 + 27B^2 \neq 0$?
\end{remark}
Đại lượng $\Delta_E = 4A^3 + 27B^2$ được gọi là \textit{phân thức của $E$}.
$\Delta_E \neq 0$ là điều kiện để đa thức $X^3 + AX + B$ có 3 nghiệm phân biệt, khi phân tích thành nhân tử $X^3 + AX + B$
ta được:
$$X^3 + AX + B = (X-e_1)(X-e_2)(X-e_3)$$


Ta biểu diễn điểm đối xứng của $P$ bởi $\ominus P = (a,-b)$, hoặc đơn giản hơn là $-P$;
ta định nghĩa $P \ominus P$ (hay $P - Q$) là $P \oplus (\ominus Q)$.
Tương tự, lặp lại phép cộng nhiều lần là biểu diễn của phép nhân một điểm với một số nguyên,
$$nP = \underbrace{P + P + P + \ldots + P}_{\text{n số hạng}}$$

\begin{theorem}
    \label{th:th1}
    Cho đường cong elliptic $E$. Luật cộng trên $E$ thỏa mãn các tính chất sau:
    \begin{tabular}{crclll}
        (a) & $P + \mathcal{O}$ & $=$ & $\mathcal{O} + P = P$ & $\forall P \in E$     & [Cộng với điểm $\mathcal{O}$] \\
        (b) & $P + (-P)$        & $=$ & $\mathcal{O}$         & $\forall P \in E$     & [Nghịch đảo]                  \\
        (c) & $(P + Q) + R$     & $=$ & $P + (Q + R)$         & $\forall P,Q,R \in E$ & [Kết hợp]                     \\
        (d) & $P + Q$           & $=$ & $ Q + P$              & $\forall P,Q \in E$   & [Giao hoán]                   \\
    \end{tabular}
\end{theorem}

\begin{theorem}
    \label{th:th2}
    Phải implement
\end{theorem}


\section{Đường cong elliptic trên trường hữu hạn}
Các ứng dụng về mật mã của đường cong Elliptic đa số chỉ sử dụng các đường
cong trên trường hữu hạn.
\subsection{Sơ bộ}
\begin{definition}
    Trường là một tập hợp K có nhiều hơn một phần tử, được định nghĩa hai phép toán cộng và nhân,
    ký hiệu bởi dấu $(+)$ và dấu $(.)$. Trường thỏa mãn các tính chất của số học.
\end{definition}
Các tính chất số học:
TODO:
\begin{enumerate}
    \item Tính kết hợp
    \item Tính giao hoán
    \item Đơn vị cộng và đơn vị nhân
    \item Nghịch đảo phép cộng
    \item Nghịch đảo phép nhân
    \item Tính phân phối
\end{enumerate}

\begin{definition}
    Trường hữu hạn (còn gọi là trường Galois) là những trường có hữu hạn số phần tử.
    Bậc của một trường hữu hạn là số phần tử của nó, là số nguyên tố hoặc lũy thừa nguyên tố.
\end{definition}
Trường hữu hạn là cơ bản trong một số lĩnh vực toán học và khoa học máy tính,
bao gồm lý thuyết số, hình học đại số, lý thuyết Galois, hình học hữu hạn, mật mã và lý thuyết mã hóa.

Xét $F_p$ là một trường hữu hạn (hữu hạn số phần tử nguyên dương):
$$F_p = \{0, 1, 2, \ldots p-1\}$$
Với $p$ là một số nguyên tố. $F_p$ giống như cách viết $Z/mZ$ là vành các số nguyên modulo $m$.
\subsection{Đường cong elliptic trên trường hữu hạn}
Để áp dụng hệ quả của đường cong Elliptic vào mật mã, ta xét các
đường cong mà các điểm của nó có toạ độ xác định trong $F_p$

Ta định nghĩa một đường cong elliptic $E$ trên trường hữu hạn $F_q$ là một phương trình có dạng:
$$E: Y^2 = X^3 + AX + B\ \text{với các hằng số}\ A, B \in F_p\ \text{thỏa mãn}\ 4A^3 + 27B^2 \neq 0$$


Tập hợp các điểm trên $E$ có toạ độ thuộc $F_p$ được kí hiệu bởi
$$E(F_p) = \{(x, y) : x, y \in F_p\ \text{thỏa mãn}\ y^2 = x^3 + A x + B\} \cup \mathcal{O}$$

\end{document}